<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd"><html><head><title>SQL Overview</title><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></head><body><? // grab the headerinclude 'notes-header.php' ; ?><h1 align="center"><font color="#000099">An Overview of SQL </font></h1><p align="right"><font size="-1">Last Modified   <!-- #BeginDate format:Am2 -->4/6/11<!-- #EndDate --></font></p><p align="center">	<font size="1">		<a href="#intro">Introduction</a> &bull; 		<a href="#datatypes">Data Types</a> &bull; 		<a href="#create">Creating Tables</a> &bull; 		<a href="#insert">Inserting Data</a> &bull; 		<a href="#select">Retrieving Data</a> &bull; 		<a href="#derby">Derby/Netbeans</a></font></p><hr><h2><font color="#990033"><a name="intro"></a><font color="#000099">Introduction</font></font></h2><p>We'll use a system called <strong>SQL</strong> to manipulate databases. </p><p>SQL allows us functionality in setting up databases:</p><ul>  <li>We can use <font face="Courier New, Courier, mono">create database</font> to create a database. There are also features for switching between databases. </li>  <li>We can use <font face="Courier New, Courier, mono">create table</font> to create the tables that make up a database. </li></ul><p>SQL allows us functionality in manipulating the contents of tables:</p><ul>  <li>Via <font face="Courier New, Courier, mono">insert</font> statements, we can add records to tables.</li>  <li>Via <font face="Courier New, Courier, mono">update</font> statements, we can change the data in existing records.</li>  <li>Via <font face="Courier New, Courier, mono">delete</font> statements, we can remove entire records. </li></ul><p>Finally, SQL allows us to retrieve data from tables:</p><ul>  <li>The <font face="Courier New, Courier, mono">select</font> statement allows this.</li>  <li>We can also do more complicated <font face="Courier New, Courier, mono">select</font> statements with concepts such as <font face="Courier New, Courier, mono">join</font>s and subqueries that allow us to use tables together in extremely powerful ways. </li></ul><p>SQL is quite different from the programming language experiences you've had thus far. Instead of telling SQL <em>how</em> to get the information you want, you use SQL to say <em>what</em> you want. For example:</p><ul>  <li>In C++ or Java, to retrieve all of the employees from a database whose hourly wage is at least $10, you would likely write a for loop to iterate through all the elements of an array (or some other structure), with a nested if statement checking the salaries. </li>  <li>In SQL, you'd write a statement like so: <font face="Courier New, Courier, mono"><br>  select * from employees where salary > 10;</font></li></ul><p>Let's note a few technical details:</p><ul>  <li>SQL is case-insensitive. </li>  <li>Lines of SQL code end in semicolons. (Exception: not necessary for one statement, but it's nice to get in the habit anyway.)</li>  <li>Block-style comments (<font face="Courier New, Courier, mono">/* ... */</font>) are allowed. </li>  <li>There are various flavors of SQL that have slight differences. What I'll teach you is <a href="#derby">Apache Derby</a>'s flavor (and the majority of what I'll show you is common to MySQL and Derby). </li></ul><p>&nbsp;</p><p>&nbsp;</p><p align="center"><font size="1"><a href="#intro">Introduction</a> &bull; <a href="#datatypes">Data Types</a> &bull; <a href="#create">Creating Tables</a> &bull; <a href="#insert">Inserting Data</a> &bull; <a href="#select">Retrieving Data</a> &bull; <a href="#derby">Derby/Netbeans</a></font> </p><hr><h2><font color="#990033"><a name="datatypes"></a><font color="#000099">Data Types</font></font></h2><p>Various data types are available, similar to what you know in Java. Here are some you're likely to use:</p><table border="1">  <tr>    <th width="150" scope="col">Data Type </th>    <th scope="col">Notes</th>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">char(<em>n</em>)</font></td>    <td>Fixed-length string of <em>n</em> characters. </td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">varchar(<em>n</em>)</font></td>    <td>Same as above, but variable-length. Recommended in general. </td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">smallint</font></td>    <td>16 bit, i.e. accepts values ranging from -2<sup>15</sup> to 2<sup>15</sup>-1</td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">integer</font></td>    <td>32 bit, i.e. accepts values ranging from -2<sup>31</sup> to 2<sup>31</sup>-1 <font size="1">(<font face="Courier New, Courier, mono">int</font> in MySQL)</font> </td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">float</font></td>    <td rowspan="2">Floating point numbers </td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">double</font></td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">date</font></td>    <td>Format YYYY-MM-DD</td>  </tr>  <tr>    <td width="150"><font face="Courier New, Courier, mono">time</font></td>    <td>Format HH:MM:SS </td>  </tr></table><p>&nbsp;</p><p><font size="1">In MySQL, <font face="Courier New, Courier, mono">float</font> and <font face="Courier New, Courier, mono">double</font> require two arguments in parentheses: <em>p</em> and <em>s. </em>with precision <em>p</em> (i.e. <em>p</em> total allowable digits) and scale <em>s</em> (i.e. <em>s</em> digits to the right of the decimal point). float will be fine most of the time, with values in the range of approximately&plusmn; 3.4e38 (while double goes to &plusmn; 1.9e308.)</font></p><p align="center">&nbsp;</p><p align="center"><font size="1"><a href="#intro">Introduction</a> &bull; <a href="#datatypes">Data Types</a> &bull; <a href="#create">Creating Tables</a> &bull; <a href="#insert">Inserting Data</a> &bull; <a href="#select">Retrieving Data</a> &bull; <a href="#derby">Derby/Netbeans</a></font> </p><hr><h2><font color="#990033"><a name="create"></a><font color="#000099">Creating Tables</font></font></h2><p>We can create a table with the SQL command <font face="Courier New, Courier, mono">create table</font>. We'll essentially list off our variables and their types. </p><p>The general syntax is:</p><blockquote>  <pre><strong><font color="#336600">create table</font></strong> <em>tableName</em> <font color="#336600"><strong>(</strong></font>    <em>name type,     /* more ... */    name type</em><font color="#336600"><strong>);</strong> </font></pre></blockquote><p>Note that, unlike Java, types come after names, commas follow all but the last declaration, and we use parentheses instead of braces around the entire table definition. </p><p>Consider this example:</p><blockquote>  <pre>/* Table to hold information about various PSU courses */<br>create table courses<br>(<br>   course_id smallint,                              /* id, primary key                    */<br>   dept varchar(5),                                 /* department abbrev, e.g. CMPSC      */<br>   number smallint,                                 /* catalog number, e.g. 221           */<br>   name varchar(30),                                /* course title                       */<br>   credits smallint,                                /* number of credits                  */<br>   num_sections smallint,                           /* how many sections are offered now  */<br>   major_notes varchar(30)                          /* who requires it? a service course? */<br>); </pre></blockquote><p>&nbsp;</p><h3><font color="#990033"><font color="#000099">Primary Keys and Required Fields </font></font></h3><p>Some other restrictions can be specified in our declarations.</p><p>One is that we specify some fields to require values. We do this by adding <font color="#336600" face="Courier New, Courier, mono"><strong>not null</strong></font> to the end of their declarations. </p><p>We can also specify fields to be primary keys. We do this by adding a <strong>constraint</strong> to the table. Here's a general form of how to define a primary key constraint: </p><blockquote>  <pre><font color="#336600"><strong>constraint pk_</strong></font><em>tableName</em><font color="#336600"><strong> primary key ( </strong></font><em>primary key field name</em><font color="#336600"><strong> )</strong></font></pre></blockquote><p>&nbsp;</p><p>Here's an improved version of the above definition: </p><blockquote>  <pre>/* Table to hold information about various PSU courses */<br>create table courses<br>(<br>   course_id smallint <strong><font color="#336600">not null</font></strong>,                     /* id, primary key                    */<br>   dept varchar(5),                                 /* department abbrev, e.g. CMPSC      */<br>   number smallint,                                 /* catalog number, e.g. 221           */<br>   name varchar(30),                                /* course title                       */<br>   credits smallint,                                /* number of credits                  */<br>   num_sections smallint,                           /* how many sections are offered now  */<br>   major_notes varchar(30),                         /* who requires it? a service course? */<br>   <font color="#336600"><strong>constraint pk_courses primary key (course_id)</strong></font><br>); </pre></blockquote><p>&nbsp; </p><p>&nbsp;</p><p>&nbsp;</p><p align="center"><font size="1"><a href="#intro">Introduction</a> &bull; <a href="#datatypes">Data Types</a> &bull; <a href="#create">Creating Tables</a> &bull; <a href="#insert">Inserting Data</a> &bull; <a href="#select">Retrieving Data</a> &bull; <a href="#derby">Derby/Netbeans</a></font> </p><hr><h2><font color="#990033"><a name="insert"></a><font color="#000099">Inserting Data into Tables </font></font></h2><p>Great, so we've got a table. How do we put data into it with SQL? The <font face="Courier New, Courier, mono">insert</font> statement comes into play here. </p><p>Here's the general form of an insert statement:</p><blockquote>  <pre><strong><font color="#336600">insert into</font></strong> <em>table_name</em><strong><font color="#336600">   (</font></strong><em>field_name_1</em><font color="#336600"><strong>,</strong></font> <em>field_name_2</em><strong><font color="#336600">,</font></strong> <em>etc.</em><strong><font color="#336600">)   values (</font></strong><em>value_for_field_name_1</em><font color="#336600"><strong>,</strong></font> <em>value_for_field_name_2</em><strong><font color="#336600">,</font></strong> <em>etc.</em><strong><font color="#336600"></font></strong><font color="#336600"><strong>);</strong></font></pre></blockquote><p><strong>Note: </strong>Strings in SQL are given inside single quotes, e.g. <font face="Courier New, Courier, mono">'This string will work'</font> NOT <font face="Courier New, Courier, mono">&quot;This one will make you wonder why the computer's mad at you.&quot;</font> </p><p>Consider these examples: </p><blockquote>  <pre>insert into courses   (course_id, dept, number, name, credits, num_sections)   values (0, 'CMPSC', 111, 'Logic of CS Seminar', 1, 1);insert into courses   (course_id, dept, number, name, credits, num_sections, major_notes)   values (1, 'CMPSC', 121, 'Intro to Programming Tech', 3, 3, 'CMPSC, CMPEN Required');</pre></blockquote><p>&nbsp;</p><p><strong>Exercise 0:</strong> Given the above examples, are the following statements valid? Why or why not? </p><blockquote>  <pre>insert into courses   (dept, number)   values ('MATH', 140);insert into courses   (course_id, dept, number)   values (1, 'MATH', 140);</pre></blockquote><p>&nbsp;</p><p><strong>Exercise 1:</strong> Write a statement to insert a CMPSC 122, specifying the name of the course as &quot;Intermediate Programming&quot; only. (Hint: write your solutions in a text file so that you can copy and paste them in lab.) </p><p>&nbsp;</p><p><strong>Exercise  floor(Math.E):</strong> Write a statement to insert this course into the table with as much information as possible.</p><p>&nbsp;</p><p><strong>Exercise floor(Math.PI): </strong>Write two more insert statements for courses you have taken for the major. </p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><blockquote>  <p>&nbsp;</p>  <p align="center"><font size="1"><a href="#intro">Introduction</a> &bull; <a href="#datatypes">Data Types</a> &bull; <a href="#create">Creating Tables</a> &bull; <a href="#insert">Inserting Data</a> &bull; <a href="#select">Retrieving Data</a> &bull; <a href="#derby">Derby/Netbeans</a></font> </p></blockquote><hr><h2><font color="#990033"><a name="select"></a><font color="#000099">Retrieving Information from Tables </font></font></h2><p>Naturally, we want to retrieve and process the information we store in database tables. We'll use the SQL <font face="Courier New, Courier, mono">select</font> statement to do this. The select statement will afford us tremendous power. We'll start today with some simple examples and spend an entire class talking it in detail next time. </p><p>The simplest form of a select statement allows us to retrieve everything from all of the rows of a table: </p><blockquote>  <pre><strong><font color="#336600">select * from</font></strong> <em>tableName</em><strong><font color="#336600">;</font></strong></pre></blockquote><p>For example, the following gives us all of the information in the courses table: </p><blockquote>  <pre>select * from courses;</pre></blockquote><p>&nbsp;</p><p>We could also request to look at only certain fields:</p><blockquote>  <pre><strong><font color="#336600">select </font></strong><em>field1</em><strong><font color="#336600">,</font></strong><em> field2</em><strong><font color="#336600">,</font></strong><em> ...</em><strong><font color="#336600"> from</font></strong> <em>tableName</em><strong><font color="#336600">;</font></strong></pre></blockquote><p>For example, the following will list only the departments, course numbers, and course names we have inserted into the courses table: </p><blockquote>  <pre>select dept, number, name from courses;</pre></blockquote><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p align="center"><font size="1"><a href="#intro">Introduction</a> &bull; <a href="#datatypes">Data Types</a> &bull; <a href="#create">Creating Tables</a> &bull; <a href="#insert">Inserting Data</a> &bull; <a href="#select">Retrieving Data</a> &bull; <a href="#derby">Derby/Netbeans</a></font> </p><hr><h2><font color="#990033"><a name="derby"></a><font color="#000099">Apache Derby/NetBeans Setup </font></font></h2><p>NetBeans provides us access to a database system called Apache Derby. We'll use this system, as it requires minimal setup compared to alternatives. </p><p>To access the Derby databases, use the <strong>Services</strong> tab (beside <strong>Projects</strong> and <strong>Files</strong>). You'll notice a few example databases are provided. Here's how to create a database for our example from the notes and feed it SQL commands:</p><ol>  <li>Under <strong>Databases</strong>, right-click <strong>JavaDB</strong>.</li>  <li>Select <strong>Create Database</strong>. </li>  <li>Fill in a <strong>Database Name</strong>, <strong>User Name</strong>, and <strong>Password</strong>. This is the IDE's way of doing the <font face="Courier New, Courier, mono">create database</font>. You won't use the user name and password for anything in this course. We'll use some typical default values: &quot;root&quot; for both. </li>  <li>Your database should appear under <strong>Databases </strong>now. Right-click it and choose <strong>Connect</strong>. </li>  <li>Right-click the database again and choose <strong>Execute Command</strong>. This will open a text area labeled <strong>SQL Command 1</strong> where you can enter code. </li>  <li>Above the text area, you need to use the <strong>Connection</strong> drop down menu to select the correct database. (You may need to make the NetBeans window rather wide to see this as it may be hidden.) </li>  <li>Enter your SQL commands in the text area and use <strong>Ctrl+Shift+E</strong> or <strong>Command+Shift+E</strong> to execute them. </li></ol><p>Let's try this out as a lab... </p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p align="center"><font size="1"><a href="#intro">Introduction</a> &bull; <a href="#datatypes">Data Types</a> &bull; <a href="#create">Creating Tables</a> &bull; <a href="#insert">Inserting Data</a> &bull; <a href="#select">Retrieving Data</a> &bull; <a href="#derby">Derby/Netbeans</a></font> </p></body></html>